【学习链接】
- https://www.bilibili.com/video/BV1Yh411o7Sz?p=36&spm_id_from=pageDriver
- https://book.apeland.cn/details/154/


- 多线程 threading： 一个人有与异性聊天和看剧两件事要做。单线程的她可以看完剧再去聊天，但这样子可能就没人陪她聊天了「哼，发消息不回」。
我们把她看成一个CPU核心，为她开起多线程——先看一会剧，偶尔看看新消息，在两件事（线程）间来回切换。
多线程：单个CPU核心可以同时做几件事，不至于卡在某一步傻等着；CPU通过切片的方式来切换线程间的执行（某线程io时，切换另一个线程执行），线程切换时需要耗时（保存状态，下次继续）
    - 特点：传统多线程方案会使用“即时创建， 即时销毁”的策略
    - 用处：爬取网站信息（爬虫），等待多个用户输入
    - 缺点：python中的多线程无法利用多核优势，其根源是 GIL【 Global Interpreter Lock(全局解释器锁)】 的存在
        - GIL 本质就是一把互斥锁，既然是互斥锁，所有互斥锁的本质都一样，都是将并发运行变成串行，以此来控制同一时间内共享数据只能被一个任务所修改，进而保证数据安全
            - 【GIL】https://blog.csdn.net/weixin_41594007/article/details/79485847
        - 可用 队列 代替 互斥锁（主要用于生产者消费者模式，100例）
    - 开几个线程？
        - 与要解决的业务需求有关，（或者试验？）；一般如果是io密集型，每个cpu核心开两个线程，如果是cpu密集型，建议每个cpu核心开一个


- 多进程 processing： 一个人有很多砖需要搬，他领取手套、推车各种物资（向系统申请了资源）然后开始搬砖。
然而他身边有很多人，我们让这些人去帮他！（一核有难，八核围观）。于是他们做了分工，砖很快就搬完了。
多进程让多个CPU核心可以一起做事，不至于只有一人干活而其他人傻站着。
    - 用处：
        - 进行高性能计算。只有多进程方案设计合理，才能加速计算；就对Python而言，可以实现真正的并行效果；
        - 开多进程的目的是为了并发，如果有多核，通常有几个核就开几个进程
    - 特点：
        - 多进程耗内存，所以注意内存的优化


- 选择多线程还是多进程？
    - CPU 密集型：程序比较偏重于计算，需要经常使用 CPU 来运算。例如科学计算的程序，机器学习的程序等。
        - 程序是属于 CPU 密集型，建议使用多进程
    - I/O 密集型：顾名思义就是程序需要频繁进行输入输出操作。爬虫程序就是典型的 I/O 密集型程序（如文件读写，web 请求，数据库请求 等）。
        - 多线程就更适合应用于 I/O 密集型程序
    
- 线程与进程的关系
    - 1）一个线程只能属于一个进程，而一个进程可以有多个线程，但至少有一个线程（线程是计算机的最小单位）；
    - 2）资源分配给进程，同一进程的所有线程共享该进程的所有资源，进程与进程之间资源相互独立，互不影响（类似深拷贝）;
    - 3）多进程模式最大的优点就是稳定性高，因为一个子进程崩溃了，不会影响主进程和其他子进程，多进程模式的缺点是在Windows下创建进程开销巨大。
         另外，操作系统能同时运行的进程数也是有限的，在内存和CPU的限制下，如果有几千个进程同时运行，操作系统连调度都会成问题（进程的创建比线程的创建更加占用计算机资源）；
    - 4）多线程模式致命的缺点就是任何一个线程挂掉都可能直接造成整个进程崩溃，因为所有线程共享进程的内存；
    - 5）由于GIL锁的缘故，python 中线程实际上是并发运行（即便有多个cpu，线程会在其中一个cpu来回切换，只占用一个cpu资源），
         而进程才是真正的并行（同时执行多个任务，占用多个cpu资源）。
    
- 线程并发 和 进程并行
    - 【并发与并行】https://blog.csdn.net/weixin_41594007/article/details/79485847
    - 并行是指两个或者多个事件在同一时刻发生，python中的进程属于并行，能充分利用计算机资源，效率最高，同时执行多个任务，占用多个cpu资源；
    - 并发是指两个或多个事件在同一时间间隔发生，python中的线程属于并发，不管计算机有多少个CPU，
      不管你开了多少个线程，同一时间多个任务会在其中一个CPU来回切换，只占用一个CPU，效率并不高